#coding=utf-8
import cx_Oracle
import requests
from lxml import etree
import time


#获取页面
def get_html(url,data):
   data = data
   url = url
   headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:94.0) Gecko/20100101 Firefox/94.0'}
   html = requests.post(url=url, headers=headers, data=data).text
   return html

#传入表达式提取出数据
def xpathHtml(expr, html):
   xhtml = etree.HTML(html)
   r_list = xhtml.xpath(expr)
   return r_list

#按站位制作列表
def makeList(r_list,):
   fr=[]
   temp=[]
   for r in r_list:
      r=r.strip()
      if r:
         if 'LINE' in r.upper():
            fr.append(temp)
            temp=[]
            temp.append(r)
         else:
            temp.append(r)
   fr.append(temp)
   fr.pop(0)
   return fr

#对于feeder为空的情况,插入feeder_error
def parseList(list1):
   temp=[]
   for l in list1:
      if len(l[3])<5:
         l.insert(3,'feeder error')
         temp.append(l)
      else:
         temp.append(l)
   return temp

#写入oracle
def listToOracle(carList):
   try:
        # conn = cx_Oracle.connect('fuji/fuji@10.10.31.115/orcl')
        # cur = conn.cursor()
        dsn_tns = cx_Oracle.makedsn('10.11.16.74', '1521', service_name='orcl')
        conn = cx_Oracle.connect(user='A01_SMT_BOARD', password='A@a111111', dsn=dsn_tns)
        cur = conn.cursor()
        #cur.executemany('insert into fujiweb2 values(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,now())', carList)
        cur.executemany("insert into A01_SMT_BOARD.T_PM_LD values(:1, :2, :3, :4, :5, :6, :7,:8,:9,:10,:11,:12, :13,:14,:15,:16,:17,:18, :19,(select sysdate from dual))",carList)
        conn.commit()
        cur.close()
        conn.close()
        # log=str('insert {} OK '.format(carList[0][0])+time.strftime("%Y-%m-%d %H:%M:%S", time.localtime()))
        # log_list.append(log)
        # log_list.append('\n')
        # print(log)
   except Exception as e:
        log=str(time.strftime("%Y-%m-%d %H:%M:%S", time.localtime()))+e
        log_list.append(log)
        log_list.append('\n')
        print(e)


#gd2_form_data
data2_stronger = {
  #"__EVENTTARGET": "",
  #"__EVENTARGUMENT": "",
  #"__LASTFOCUS": "",
  "__VIEWSTATE": "/wEPDwUJNzkyNzQzMzk2D2QWAmYPZBYaAgEPZBYEZg8PFgIeBFRleHQFDOeUn+S6p+S/oeaBr2RkAgMPDxYGHwAFEHdvcmtpbmcgb24gRmxleGEeCENzc0NsYXNzBQlXaGl0ZVRleHQeBF8hU0ICAmRkAgMPZBYGZg9kFhBmD2QWAmYPZBYEZg8PFgIfAAUG5rOo6ZSAZGQCAQ8PFgIeB1Rvb2xUaXAFJOeCueWHu+ivpeaMiemSru+8jOS9v+iPnOWNleacgOWwj+WMlmRkAgMPZBYCZg9kFgJmDw8WAh8ABQ/lnKjnur/nm5Hop4blmahkZAIED2QWAmYPZBYCZg8PFgQfAAUM6K2m5ZGK57O757ufHgdWaXNpYmxlaGRkAgUPZBYCZg9kFgJmDw8WAh8ABQzplJnor6/mo4DntKJkZAIGD2QWAmYPZBYCZg8PFgIfAAU06Ieq5Yqo5o2i57q/PGJyPiZuYnNwOyZuYnNwO++8iOaJi+aMgeW8j+aJq+aPj+WZqO+8iWRkAgwPZBYCZg9kFgJmDw8WBB8ABQzns7vnu5/orr7lrpofBGdkZAIND2QWAmYPZBYCZg8PFgIfAAUM54q25oCB5Y+C54WnZGQCEQ9kFgJmD2QWAgIBDxYCHgtfIUl0ZW1Db3VudGZkAgEPFgIfBGgWAmYPZBYCZg9kFgJmDw8WAh8DBSHngrnlh7vor6XmjInpkq7vvIzkvb/oj5zljZXlpI3ljp9kZAICDxYCHwRoZAIFDw8WAh8ABQwxMi1MaW5lLVNNVDNkZAIHDw9kFgIeBXN0eWxlBSVtYXJnaW4tbGVmdDoyOTBweDt2aXNpYmlsaXR5OnZpc2libGU7FgxmDw8WAh4ISW1hZ2VVcmwFC2ltZy9yZXcucG5nZGQCAg8PZBYCHwYFEnZpc2liaWxpdHk6aGlkZGVuO2QCAw8PFgIfBwUPaW1nL2ZvcndhcmQucG5nFgIfBgUSdmlzaWJpbGl0eTpoaWRkZW47ZAIEDw8WAh8HBbIMZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFDQUFBQUFnQ0FZQUFBQnplbnIwQUFBQUFYTlNSMElBcnM0YzZRQUFBQVJuUVUxQkFBQ3hqd3Y4WVFVQUFBQUpjRWhaY3dBQURzTUFBQTdEQWNkdnFHUUFBQVFxU1VSQlZGaEh6VlpiVDF4VkdOM0R6QUFqNldXbW9pMHRGSXBsR0tiVlNrZ3BoVTZiSnBnYUg5ckVFRTFNdEEvYStPQ0RNVDcyU2FWYUs5T0tsMmk4MVY2MHRLRk54WXhvaGs0a2t3QkswaEJEZlBBUDBCZWV1TitXZTIzWnAzczJjMkJvVStra0gyZSs3Nnh2cmZWOSt4eEFDT3NUajhkaGhuMS9OWGtxbFNxMCtLYVg5aDhRcjRzbWtWQVJFOTJqbzZNd2c3VjdqVUJ6NERlVGErVE95THpEUlQxcWkwWnh5M2ZHQjIrYkY3NVRYZ3dQRDJmRXZvdTdjTFE3aHBkNm5zRnI2V040ODg4WGNITG9GWmlmdG4vZVFPdmZKMlQ5dU1JUXk1N21qbjBaWExmL3VvMkMwMzc0NHo3NDJueWd0aklnUGhBUVoyUWNGMmh2Yjg4SWIwc2U5blJzUWNQMU1oeit1UkxQL1ZydGFKLzRZNi96L2VWMExWcFN1eFdHV1BZRVhpM0k0SXFmaThQVDRvRXZuZ2Z4a2RSVEJwcEVTaG40VUNEdmJROGlEUkZFNmlPb3FZdGdWME1VSlNmWDRja3JtN0czY3hzTy9sU0JJNzlVNFZneWloZC9md29VMVIvbXJCTkRMSHZLVzBPSTdxOUJkSkV2VWwrTi9MZTg4TklBQjZhMit2RytURTVMQTIwZUZIN3N3L3BQQzFEOFJSRkt2OW1BSjc3ZmhPZ1BqNlAyYWduMjM5aXVKbnkyTzR5anlScEgvUGxiOHBoa3pqb3h4TEtIdmVRZ0Z6bkp6YUFPQjc1cjRKUk11QVc1bHZ5elhoUjlrby9RNXdGcytXb2R5cjhMSW56eFVleitjVFBxcm0xVkFvZTZkamppRkQzU1hZWG14RTVWSjRaWTlyQ1hIT1FpSjdrTHovbi9XNzhjT05NQVRVaFgzcmdIQVdNTFc3OWVqNHJ6UVZSZktsYkVuRTUvRHR3c1IreG1CWGh0bE1icU8wc1ZobGoyc0ZkUFQwNXlGOUFBcCtmQXpoRzhKNVBXdTF2d244M0RJKzErYlBpc0VNVmZGaWtpRWxiSnFXb3VQNWJ4QnVqazZZNFNkZTdFT09LeWx4emtJcWVhbkVGeEhydGo0RjJadkNPRFc1Q3I4ZWlqMENia0daYklWWlo5dXhFN3pvZXc4OEltTldWRW1xRWhYcG16VGd5eG5KemlSWktEcXllbldqdURPaHhZR1JEaTRNTENBdWJuNTNPT3ViazVaSXZWY0ZDVDJ2ZHNZSFoyRm1iUVVLNEdOTll4d0VhM3FiTFZiWEdkcjRhRG1nK1hBYmVwZEYyNnBlT010Uy9Yc3hKK3lRYmN5RFRSU29SMi8wcjRyQVptWm1iZ0ZwcFEzN2NGelQ3VHRCc2ZueGZuR1dDeW5EanZyYW1CNmVscHh3Qy9NK3dONkxwOVpMcHVYNWRzd0Exb0V6L1VCdlQwVTFOVHpzYjRQVnR3Zzg0endNUU5xT3NtdWRzUnJLa0JMVDQ1T1FtR25ldTZ2aTdaZ0Eyd2M1T1FXM0Y3NzlmRWdQM2syemxOVFV4TVpNVGlxeDFUZncyWjJBQTcxNlNzWjlzQWEyYVBpYy9HL2I4YkdCb2FRaUtSUUU5UER3WUdCdERiMnpzaVRXNTBOakErUG83bFFrOUVERmRxUHdPc21mMG1udld1cmk3d254QnVvNysvZnp3WURKWlJQR2NESm5rdUJ1eGhrc2treHNiR01EZzRPRlZaV1ZtcnhYbU44YjNtelZ4RGI4RjhVMWhicnIrdnI0K3Jud2lIdzNXbXVETEEzOHNyL1NxKzMvdnBkUHBPS0JTSzJPTE1TMlUwTGthVHZENklJUCsyYk9ML0FuZ284TTdKYVMxVUFBQUFBRWxGVGtTdVFtQ0NkZAIFDw8WAh8HBcoMZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFDQUFBQUFnQ0FZQUFBQnplbnIwQUFBQUFYTlNSMElBcnM0YzZRQUFBQVJuUVUxQkFBQ3hqd3Y4WVFVQUFBQUpjRWhaY3dBQURzTUFBQTdEQWNkdnFHUUFBQVE3U1VSQlZGaEh6VlpiYjFSVkdOM1RtV2s3Tmx4bXNBcUYxcFpLcDlNQkwwMURLUzJETWFuQitBQ0phVFFoQVI2VThNQ0RJVHp5QkJaRjdJRDFFbzAzRkcvVmdNR2FzWm9wRTV0SjJtb1QwcERHQi85QWVlbFQ3N2ZGWHB2dXc1N2RPZE1wZ25xU3IyZSt2ZGUzMXZxK2ZjNU1oYkN1ZUR3T00rejkxZVNwVktyWTRwdFpYcjlISEJNdElxRWlKbnJHeHNaZ0J0ZnVOUUt0Z2Q5TXJ0RmJvd3NPRi9Xb0xackZkZDk1SDd3ZFh2ak9lakV5TXBJUnV5NXZ4LzZlR0E3MlBvZFgwd2Z3MnA4djRkVHdZWmhYeDkvSDBmN1hVYmwrUkdHSVpVMXIxNjRNcmhzM2I2RG9uQi8rdUErK0RoK29yUXlJTndYRWVSbEhCRG83T3pQQzIxYUFwN28yb2VscUJaNzl1Um92L0ZycmFCLzlZNmZ6K1ZDNkhtMnBIUXBETEdzQ3J4UmxjTVV2eHVGcDg4QVhMNEI0VytvcEF5MGlwUXk4SlZCdzBvTklVd1NSeGdqcUdpTFkzaFJGMmFrMWVPSzdqZGg1WlF2Mi9sU0ZmYi9VNEVBeWlwZC9meElVMVJkenJoTkRMR3NxMjBPSTdxNURkSWt2MGxpTHdoTmVlR21BRFZOYi9YbERKdWVrZ1E0UGl0L3hZZTE3UlNqOXNBVGxuNjdENDE5c1FQU2JSMUgvZlJsMi8vaVk2dkQ1bmpEMkorc2M4UmV2eTJPU09kZUpJWlkxckNVSHVjaEpiZ1oxMlBCZEEyZGx3aW5Jc1JSZThLTGszVUtFUGdoZzA4ZHJVUGw1RU9ITEQyUEh0eHZSOE1ObUpmQk05MVpIbktMN2VtclFtdGltMW9raGxqV3NKUWU1eUVudTRvditPK09YRFdjYW9BbnB5aHYzSUdCTVlmTW5hMUYxS1lqYXIwb1ZNYnZUMTU1cmxZaGRxd0x2emRKWTQ1VnloU0dXTmF6VjNaT1QzRVUwd083WnNITUVyOHVrL2U0VS9CY0s4RkNuSCt2ZUwwYnBSeVdLaUlRMXNxdTZyeC9KZUFOMDhuUlhtVHAzWWh4eFdVc09jcEZUZGM2Z09JL2RNWEJHSnFkbGNBcHlOQjU5Rk5xRVBNTXlPY3FLejlaajY2VVF0bjI1UVhVWmtXWm9pSGZtWENlR1dIWk84UkxKd2RHVFU0MmRRUjAyckF3SXNYZHhjUkVMQ3d0NXgvejhQTExGYWppb1NlMTdOakEzTndjemFDaGZBeHJyR0dDaFcxZloxbTF4bmErR2c1ci9Md051WGVsMTZaYU9NOFp1NzJtTWVYZmpYVFlCTjZCTm1nMlh5OXlxRE16T3pzSXR0SWplTjRudHZWdzhlby9QaS9NTU1GbXA2RDgxTURNem84NmZ3YytN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HwAFAS1kZAIKDxUBAGQCCw8PFgIfAAUBLWRkAgwPFQEAZAINDw8WAh8ABQEtZGQCDw8PFgIfAGVkZAIMD2QWGgIBDw8WAh8AZWRkAgMPDxYCHwAFA00xMmRkAgQPFQEAZAIFDw8WAh8ABQEtZGQCBg8VAQBkAgcPDxYCHwAFAS1kZAIIDxUBAGQCCQ8PFgIfAAUBLWRkAgoPFQEAZAILDw8WAh8ABQEtZGQCDA8VAQBkAg0PDxYCHwAFAS1kZAIPDw8WAh8AZWRkAg0PZBYaAgEPDxYCHwAFDzEyLUxpbmUtU01UMy1NNmRkAgMPDxYCHwAFAk0xZGQCBA8VAQBkAgUPDxYCHwAFAS1kZAIGDxUBAGQCBw8PFgIfAAUBLWRkAggPFQEAZAIJDw8WAh8ABQEtZGQCCg8VAQBkAgsPDxYCHwAFAS1kZAIMDxUBAGQCDQ8PFgIfAAUBLWRkAg8PDxYCHwBlZGQCBg8PFgIfAAWXAuKAu+WQhOaVsOWAvOS7o+ihqOS7juesrO+8kemhuuW6j+S5i+WJjeWIsOacgOe7iOmhuuW6j+S5i+WQjueahOeUn+S6p+aXtumXtOOAgjxicj7lnKjluKbmnIk8Zm9udCBjb2xvcj0iZ3JlZW4iPio8L2ZvbnQ+55qE5Y6G5Y+y5LiK5Y+R55Sf5LqG6KGl5Lu25oiW6ICF5YGc5q2i5Zug57Sg44CC5bCG5YWJ5qCH5a+55YeG5ZCO5Y+v5Lul5Y+C6ICD6K+m57uG5YaF5a6544CCPGJyPuaYvuekuueahOmdnueUn+S6p+aXtumXtOS4jeWMheWQq+WcqOS4i+i/sOeahOeUn+S6p+aXtumXtOS4reOAgmRkGAIFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYcBRJVY0hlYWRlcjEkaWJTZWFyY2gFF1VjTWVudSRJbWFnZUJ1dHRvbkNsb3NlBQ9JbWFnZUJ1dHRvbkJhY2sFE0ltYWdlQnV0dG9uQmFja0hhbGYFFkltYWdlQnV0dG9uRm9yd2FyZEhhbGYFEkltYWdlQnV0dG9uRm9yd2FyZAUaSW1hZ2VCdXR0b25VcGRhdGVZZXN0ZXJkYXkFFkltYWdlQnV0dG9uVXBkYXRlVG9kYXkFFkltYWdlQnV0dG9uVXBkYXRlU2hpZnQFFEltYWdlQnV0dG9uVXBkYXRlMTIwBRNJbWFnZUJ1dHRvblVwZGF0ZTYwBRNJbWFnZUJ1dHRvblVwZGF0ZTMwBRFJbWFnZUJ1dHRvblVwZGF0ZQUPSW1hZ2VCdXR0b25UYWN0BRVJbWFnZUJ1dHRvblByb2R1Y3Rpb24FEkltYWdlQnV0dG9uSGlzdG9yeQURSW1hZ2VCdXR0b25QYW5lbHMFFEltYWdlQnV0dG9uUGFydFVzYWdlBRZJbWFnZUJ1dHRvbkluZm9ybWF0aW9uBRNJbWFnZUJ1dHRvbkV2ZW50TG9nBRFMaW5rQnV0dG9uUmVmcmVzaAUSSW1hZ2VCdXR0b25FYWNoSm9iBRNSYWRpb0J1dHRvblBvc2l0aW9uBQ9SYWRpb0J1dHRvbkZJREwFD1JhZGlvQnV0dG9uRklETAUVUmFkaW9CdXR0b25QYXJ0TnVtYmVyBRVSYWRpb0J1dHRvblBhcnROdW1iZXIFEUNoZWNrQm94U2hhcGVWaWV3BQpNdWx0aVZpZXcxDw9kAgRkdsio5OAlHeFoBXHDBSq5r+UM91JIiY7XsQJSOpSOS+s=",
  #"__VIEWSTATEGENERATOR": "9C1F5EDF",
  "__EVENTVALIDATION": "/wEdACVkHd/bp1xbanKXYrTJPp7B0J4eK2Fe6yzl9vedxHqyhLh6jHhWtGy+v7iWhTtOE7Qyn9o1AWpGrMI48F2UWCsGbDpLkBvxhhgNkpQKEpKrdBGcovCeb7vQjSVDhBRTQvps0iAst08a0rHslo5zV/nu9Lv7ve9EysSO6VGXmHqDBe3+MR9ycrSqOKmhQJXtO3GfBqBksFSnsAVOMH/NfLz22/YgBXLOKUJOTZm/BnynJUV3jyXV/eH2jUu6avXmp8qqi8lkH3yyLR/Ew6I3miarPRHrsX+lS07KJ1l4lNkdVqwuTrZMkXBDa297nQKB2z5ymXNje9mGByZvlbKcO/aooTOPQTroCVYNu8NKYvXNY+qJdhA+DIe2XOHtlPq2tEr2w7PZv7mAnwL9RAjhwEBYJANa5dd5BhD7EIzCFz2ZaZJ53ZgM9ZoWfWb2mVmHVvlkOQur+3IN59rnKcJvPTeRIRFDHRrZ66YaQH6vPIIRn+iaowRwWBFaNjleg3gxzihQsSuYOIiQ0iF63EtYAfgenRVa40+P14x1f8DN1lnYwVmKUI1pAIfCfnxZRVr1Z9f2gesWkeYaWW2z6rabKf2rQVFZ7fa+Th6amA3bAvgkwHgA71oqwflYo6X+cNISNKJK+0EyzSJyYkXnfH4e9X553YPNAxyjo3UatNIe5d8cNYF/Jafn3TRJLuihf7boAbJ1P3Uaq07Hc0J+QA6wESvPWedM7Mx4dH/jkw3S4DtYFi5nqt3wCAvHSoNgIdsXi7Co2/ZMB9BW1BCbY1TYZdg7Mb3SP0wMWkosUHBB6MF/iNTvrgefTeQx3sqgYj1pxHo=",
  #"UcHeader1$tbSearch": "",
  #"dtPickerFrom": "2021-11-07+15:00",
  #"dtPickerTo": "2021-11-08+15:00",
  "ImageButtonUpdate.x": "15",
  "ImageButtonUpdate.y": "13",
  "PartUsage": "RadioButtonPosition"
}

urlDict_GD2_stronger={
    'http://10.10.33.134/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-5-Line',
    'http://10.10.33.134/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-6-Line',
    'http://10.10.33.134/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-7-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-8-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-9-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-10-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-11-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-12-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-13-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-14-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-15-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-16-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-17-Line',
    # 'http://172.27.76.1/fujiweb/fujimoni/UI/TactInfo.aspx?Line=A01-20-Line',

}


#gd2格式
expr2 = "//table/tbody/tr/td//text()"


log_list=[]
def job():
    n = 0
    for url in urlDict_GD2_stronger:
       html = get_html(url,data2_stronger)
       #print(html)
       r_list=xpathHtml(expr=expr2, html=html)
       list1=makeList(r_list)
       list=parseList(list1)
       line4 = url.split('=')[1]

       for l in list:
           l.append('gd2_stronger')
           l.append(line4)
           n+=1
           #print(l)

       #listToOracle(list)
       print(list)
    #print(n)

    with open('log.txt', 'a') as f:
        f.writelines(log_list)
        f.write('*'* 50)
        f.write('\n')


job()